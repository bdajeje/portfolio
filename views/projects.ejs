<% // Split projects by category
  var categories = {};
  projects.forEach(function(project) {
    if( !categories[project.type] )
      categories[project.type] = [];

    categories[project.type].push( project );
  }) %>

<% // For each category
  Object.keys(categories).forEach(function(category_type) {  %>
  <h2>
    <span class="before"> </span>
    <%= __(category_type) %>
    <span class="after"> </span>
  </h2>

  <% // For each project
    var row_size = 5;
    var projects = categories[category_type];
    for(var i = 0; i < projects.length; ++i) {
      var project = projects[i];

      if(i % row_size == 0) { %>
        <div class="row">
      <% } %>

      <a href="<%= routes.project.replace(':name', project.urlName()) %>" class="flip-container" ontouchstart="this.classList.toggle('hover');">
        <div class="flipper">
          <div class="front">
            <h3 class="title"><%= project.name %></h3>
            <img src="/images/projects/<%= project.name %>.png" class="icon" />
          </div>
          <div class="back">
            <div class="description"><%- project.project_texts[0].text %></div>
          </div>
        </div>
      </a>

      <% if(i != 0 && ((i+1) % row_size) == 0 || i == projects.length) { %>
        </div>
      <% } %>

    <% } %>

<% }) %>
